[dungeon]
size: Size2d = {80, 24}
wall: Tile = {'#', "#142314"}
ground: Tile = {' ', "#222222"}

[builder_alias]
map_filler_ground = map_filler
map_filler_walls = map_filler
erode_walls = celalt_map_filler
foilage_spawner_ground = celalt_map_filler
pine_tree_placer = filter_placer
oak_tree_placer = filter_placer
iron_tree_placer = filter_placer
fairy_spawner = room_entity_placer
blood_fairy_spawner = room_entity_placer
chest_placer = room_entity_placer
grove_guardian_spawner = room_entity_placer

[sequence]
 - map_filler_ground
 - foilage_spawner_ground
 - map_filler_walls
 - room_placer
 - erode_walls
 - loop_placer
 - start_end_placer
 - chest_placer
 - pine_tree_placer
 - oak_tree_placer
 - iron_tree_placer
 - fairy_spawner
 - blood_fairy_spawner
 - grove_guardian_spawner

[map_filler_ground]
tile: Tile = {' ', "#222222"}
layer = ground

[foilage_spawner_ground]
tile: Tile = {'"', "#28aa1e"}
layer = ground_deco
spawn_chance = 0.25
smooth_thres = 6U

[map_filler_walls]
tile: Tile = {'#', "#142314"}
layer = walls

[erode_walls]
clear_tile: Tile = {'#', "#5a8551"}
layer = walls
spawn_chance = 0.3
smooth_thres = 5U
kill_thres = 6U
rect: Rect2d = {{1, 1}, {78, 22}}

[room_generator]
room_size_min_max: Rect2d = {{8, 8}, {14, 14}}

[room_placer]
layer = walls
room_generator = cave_room_generator
num_new_room_attempts = 50U

[chest_placer]
layer = entities
entity: Tile = {'C', "#fac43c"}
room_percentage = 60.0

[fairy_spawner]
layer = entities
entity: Tile = {'f', "#f2f2f2"}
room_percentage = 10.0
room_count_min = 1U
room_count_max = 2U

[blood_fairy_spawner]
layer = entities
entity: Tile = {'b', "#f2f2f2"}
room_percentage = 10.0
room_count_min = 2U
room_count_max = 4U

[grove_guardian_spawner]
layer = entities
entity: Tile = {'G', "#f2f2f2"}
room_percentage = 40.0
room_count_min = 1U
room_count_max = 2U

[loop_placer]
layer = walls
max_loops = 30U
max_used_doors = 5U

[start_end_placer]
layer = entities
check_layer = walls
start_tile: Tile = {'H', "#489dcf"}
end_tile: Tile = {'<', "#489dcf"}
num_ends = 1U
distance_thres = 0.4

[pine_tree_placer]
filter_layer = walls
place_layer = entities
filter_tile: Tile = {'#', "#142314"}
place_tile: Tile = {'A', "#ffffff"}
place_percentage = 30.0
filter8x_count_thres_min = 2U
filter8x_count_thres_max = 8U
filter4x_count_thres_min = 1U
filter4x_count_thres_max = 3U

[oak_tree_placer]
filter_layer = walls
place_layer = entities
filter_tile: Tile = {'#', "#142314"}
place_tile: Tile = {'O', "#ffffff"}
place_percentage = 30.0
filter8x_count_thres_min = 2U
filter8x_count_thres_max = 8U
filter4x_count_thres_min = 1U
filter4x_count_thres_max = 3U

[iron_tree_placer]
filter_layer = walls
place_layer = entities
filter_tile: Tile = {'#', "#142314"}
place_tile: Tile = {'I', "#ffffff"}
place_percentage = 2.0
filter8x_count_thres_min = 2U
filter8x_count_thres_max = 8U
filter4x_count_thres_min = 1U
filter4x_count_thres_max = 3U